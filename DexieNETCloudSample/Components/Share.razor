@using DexieNET

<MudCard Class="ma-8" Elevation="0" Outlined="true">
    <MudCardHeader>
        <CardHeaderAvatar>
            <MudAvatar Color="Color.Inherit">
                <MudIcon Icon="@Icons.Material.Filled.People" />
            </MudAvatar>
        </CardHeaderAvatar>
        <CardHeaderContent>
            <MudText Typo="Typo.subtitle2">Share with</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent>
        @if (Service.Members.Any())
        {
            <MemberForm List=@List />
        }
        @if (Service.DoCanAddMember())
        {
            <InviteForm />
        }
    </MudCardContent>
</MudCard>


@code {
    [CascadingParameter]
    public required ToDoListMemberService Service { get; init; }

    [Parameter, EditorRequired]
    public required ToDoDBList List { get; init; }

    protected override Task OnInitializedAsync()
    {
        Service.SetList.Transform(List);

        return base.OnInitializedAsync();
    }

    protected override async Task OnParametersSetAsync()
    {
        if (Service.List != List)
        {
            Service.SetList.Transform(List);
        }

        await base.OnParametersSetAsync();
    }
}
